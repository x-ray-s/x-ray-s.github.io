(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{447:function(t,s,e){"use strict";e.r(s);var a=e(23),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"page-title"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[t._v("#")]),t._v(" "+t._s(t.$page.title))]),t._v(" "),e("blockquote",[e("p",[t._v("引用")])]),t._v(" "),e("h2",{attrs:{id:"安装以及启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装以及启动"}},[t._v("#")]),t._v(" 安装以及启动")]),t._v(" "),e("p",[t._v("不需要修改hosts文件，浏览器中打开"),e("a",{attrs:{href:"http://localhost:7878",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:7878"),e("OutboundLink")],1),t._v("。如果使用域名，则需要把域名指向本地，端口设置为80，浏览器中打开<http://<PROJECT>.com>。")]),t._v(" "),e("p",[t._v("安装yarn")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("npm install\nnpm install "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g nodemon "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" babel"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cli\nnpm run dev\n")])])]),e("h2",{attrs:{id:"开发模式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开发模式"}},[t._v("#")]),t._v(" 开发模式")]),t._v(" "),e("p",[t._v("执行命令结束后，浏览器中打开"),e("a",{attrs:{href:"http://localhost:3000",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:3000"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("注：js与less的编译文件为 "),e("code",[t._v("['js/*.js', 'js/**/index.js', 'less/*/*.less', 'less/**/index.less']")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm run dev---- or ----\ngulp dev\n")])])]),e("h2",{attrs:{id:"风格指南"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#风格指南"}},[t._v("#")]),t._v(" 风格指南")]),t._v(" "),e("p",[t._v("css规范 "),e("a",{attrs:{href:"https://github.com/airbnb/css",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/airbnb/css"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("js规范 "),e("a",{attrs:{href:"https://github.com/airbnb/javascript",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/airbnb/javascript"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("注释规范 "),e("a",{attrs:{href:"http://usejsdoc.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://usejsdoc.org/"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("vscode注释支持 "),e("a",{attrs:{href:"https://github.com/Microsoft/TypeScript/wiki/JsDoc-support-in-JavaScript",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/Microsoft/TypeScript/wiki/JsDoc-support-in-JavaScript"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("编辑器格式化配置 "),e("a",{attrs:{href:"http://editorconfig.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://editorconfig.org/"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"css命名规范"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#css命名规范"}},[t._v("#")]),t._v(" CSS命名规范")]),t._v(" "),e("p",[t._v("使用BEM(block__element__modifier)命名规范，为避免样式覆盖，禁止.class选择器单独使用，可嵌套在符合BEM规范的选择器内，作子选择器使用。避免嵌套过多选择器，非重用模块除外。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v(".banner ❌\n.home__banner ✅ \n\n.close ❌\n.modal__login .close ✅\n")])])]),e("h2",{attrs:{id:"js检查"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#js检查"}},[t._v("#")]),t._v(" js检查")]),t._v(" "),e("p",[t._v("使用prettier作为formatter，eslint作为lint。")]),t._v(" "),e("p",[t._v("vscode插件：")]),t._v(" "),e("ul",[e("li",[t._v("Prettier")]),t._v(" "),e("li",[t._v("EditorConfig for VS Code")]),t._v(" "),e("li",[t._v("ESLint")]),t._v(" "),e("li",[t._v("Vetur")]),t._v(" "),e("li",[t._v("Pug snippets")])]),t._v(" "),e("p",[t._v("settings.json配置")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('"eslint.validate": [ "javascript", "javascriptreact", "html", "vue" ],\n"prettier.eslintIntegration": true,\n"prettier.stylelintIntegration": true\n')])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("sudo gulp formatter\n")])])]),e("p",[t._v("vue使用eslint-plugin-vue格式化代码，js文件使用eslint --fix格式化。\n编辑器内可使用prettier插件。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("  > format document\n")])])]),e("h2",{attrs:{id:"项目结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目结构"}},[t._v("#")]),t._v(" 项目结构")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("common/ -- 后端或前后端通用js\ncontrollers/ -- 前后端控制器\ndist/ -- src编译后生成文件\ndoc/ -- 文档\nmiddlewares/ --服务端中间件\nnode_modules/\nroutes/ -- 服务端路由\nservice -- 服务端代码\nsrc/ -- 预编译文件\n  js/\n    util/ --引用工具包\n    lib/ --单独引用库\n  less/\n    ui/ --通用ui\n    common --只做注入css\n  vue/\n    components/ --组件\n    controls/ --api\n    mixins/ --混合\n    pages/ --页面级single file\n    routes/ --路由\n    bus.js --事件中间\n    domControl.js --vue中dom控制\n    web.js --入口文件\n    mobile.js --mobile入口\nstatic/ -- 静态文件\ntarget/ -- 压缩包文件\ntasks/ -- 工作流任务\n  .eslintrc.json -- 工作流eslint所需的配置\ntemp/ -- 打包临时目录\nviews/ -- 视图\ntools/ -- 工具类\n  pr.js -- 提交pr任务\napp.js\nboot.js -- 启动文件\ngulpfile.babel.js\nprocess.json -- PM2配置\nyarn.lock\n")])])]),e("h2",{attrs:{id:"路由"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#路由"}},[t._v("#")]),t._v(" 路由")]),t._v(" "),e("p",[t._v("路由尽量与文件目录相符，路由文件与视图文件对应。")]),t._v(" "),e("h2",{attrs:{id:"视图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#视图"}},[t._v("#")]),t._v(" 视图")]),t._v(" "),e("ul",[e("li",[t._v("h5 - m.pug mobile.pug")]),t._v(" "),e("li",[t._v("hybird - h.pug hybird.pug")]),t._v(" "),e("li",[t._v("web - index.pug")])]),t._v(" "),e("h2",{attrs:{id:"全局变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#全局变量"}},[t._v("#")]),t._v(" 全局变量")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ctx.state.user {Object} - 当前登录用户\nctx.state.isLogin {Boolean} - 当前登录状态\nctx.state.ua {Object} - ua信息\n\nglobal.cookieOptions - cookie设置\nglobal.<PROJECT>_OAUTH - 认证信息\n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("window._LOGIN {Boolean} - 是否登录\nwindow._USER {Object} - 当前登录用户信息\n")])])]),e("h2",{attrs:{id:"cookie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cookie"}},[t._v("#")]),t._v(" Cookie")]),t._v(" "),e("p",[t._v("页面之间的传递临时变量尽量使用session，存储非敏感信息使用storage，频繁使用的http状态使用cookie。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<PROJECT>_a_token //access token\n<PROJECT>_r_token //refresh token\n<PROJECT>_is_login //login state\nu //uid 以及 匿名生成的uid\nremember // 记住密码\n")])])]),e("h2",{attrs:{id:"fbi-warning"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#fbi-warning"}},[t._v("#")]),t._v(" FBI WARNING")]),t._v(" "),e("ul",[e("li",[t._v("vue的挂载点为dom最顶层，所有dom操作应在vue mount生命周期之后。提供一个'vue-ready'事件，观察者函数单次载入，多次会覆盖之前的绑定。")]),t._v(" "),e("li",[t._v("gulp任务新增依赖后，需要手动清空部署机的cache文件。")]),t._v(" "),e("li",[t._v("某些XMLHttpRequest POST请求返回400错误，需使用$.csrf发送请求，包装了请求token的逻辑。")]),t._v(" "),e("li",[t._v("关于请求跨域。开发模式中xmlHttpRequest通过cors.js由本地转发至线上。线上设置cors头或nginx把二级域名代理到<PROJECT>.com完成。")])]),t._v(" "),e("h2",{attrs:{id:"线上日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#线上日志"}},[t._v("#")]),t._v(" 线上日志")]),t._v(" "),e("h2",{attrs:{id:"编译机-部署机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译机-部署机"}},[t._v("#")]),t._v(" 编译机，部署机")]),t._v(" "),e("h2",{attrs:{id:"提交pr"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提交pr"}},[t._v("#")]),t._v(" 提交PR")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("node tools/pr.js -a ${assign_id} -t ${target_branch}\n")])])]),e("h2",{attrs:{id:"查看pr相关"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看pr相关"}},[t._v("#")]),t._v(" 查看PR相关")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("node tools/pr.js\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);